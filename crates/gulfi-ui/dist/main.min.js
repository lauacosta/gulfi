var initHistorial=(()=>{const a=document.querySelectorAll(`.historial-item`);for(const b of a)b.addEventListener(`click`,()=>{const a=b.textContent||``;document.getElementById(`search-input`).value=a.trim()})});var initSlider=(()=>{const a=document.getElementById(`balanceSlider`);const b=document.getElementById(`value1Display`);const c=document.getElementById(`value2Display`);const d=document.getElementById(`hiddenValue1`);const e=document.getElementById(`hiddenValue2`);if(!a||!b||!c||!e||!d)return undefined;const f=()=>{const f=a.value;const g=100- f;b.textContent=f;c.textContent=g;d.value=f;e.value=g};a.addEventListener(`input`,f)});var initKeyboard=(()=>{document.addEventListener(`keydown`,a=>{const b=document.getElementById(`search-input`);a.ctrlKey&&a.key===`b`&&(a.preventDefault(),b.focus())},!1);window.addEventListener(`keydown`,a=>{if(a.ctrlKey&&a.shiftKey&&a.key.toLowerCase()===`s`)return a.preventDefault(),a.stopImmediatePropagation(),descargarCSV(),!1},{capture:!0,passive:!1})});var updateHistorial=(async()=>{const a=document.getElementById(`historial`);if(!a)return console.error(`Elemento #historial no encontrado en el DOM.`),undefined;try{const b=await fetch(`/historial`);if(!b.ok)return a.innerHTML=`<li>Ha ocurrido un error.</li>`,undefined;const c=await b.json();a.innerHTML=``;if(c.length===0)return a.innerHTML=`<li>No se encuentran elementos.</li>`,undefined;for(const b of c){const c=document.createElement(`li`);c.textContent=b.query;c.classList.add(`historial-item`);a.appendChild(c)}}catch(b){a.innerHTML=`<li>Ha ocurrido un error.</li>`}});var descargarCSV=(()=>{if(heldData.length===0)return undefined;const a=[];a.push(heldData.join(`,`));const b=a.join(`
`);const c=new Blob([b],{type:`text/csv`});const d=URL.createObjectURL(c);const e=document.createElement(`a`);e.href=d;e.download=`busqueda.csv`;e.click();URL.revokeObjectURL(d);heldData=[];heldHeaders=[];itemsCount.textContent=0;dataWeight.textContent=`0 KB`});var hideElements=(()=>{const a=document.querySelectorAll(`.ocultable`);const b=document.getElementById(`strategy`);const c=document.querySelector(`.balance-slider`);if(b.value===`ReciprocalRankFusion`){c.style.display=`block`;for(const b of a)b.style.display=`block`}else{c.style.display=`none`;if(b.value===`Fts`)for(const b of a)b.style.display=`none`;else for(const b of a)b.style.display=`block`};b.addEventListener(`change`,()=>{if(b.value===`ReciprocalRankFusion`){c.style.display=`block`;for(const b of a)b.style.display=`block`}else{c.style.display=`none`;if(b.value===`Fts`)for(const b of a)b.style.display=`none`;else for(const b of a)b.style.display=`block`}})});var initPagination=(()=>{var i=((a,b)=>{const c=document.querySelector(`.page-info`);c.textContent=`PÃ¡gina ${a+ 1} de ${b}`});var g=(a=>{const c=a*b;const f=c+ b;d.forEach((a,b)=>{a.style.display=b>=c&&b<f?``:`none`});i(a,e)});var h=((a,b,d)=>{const f=document.createElement(`button`);f.textContent=`<<`;f.addEventListener(`click`,()=>{c=0;d(c)});const g=document.createElement(`button`);g.textContent=`<`;g.addEventListener(`click`,()=>{c>0&&d(--c)});const h=document.createElement(`span`);h.classList.add(`page-info`);const j=document.createElement(`button`);j.textContent=`>`;j.addEventListener(`click`,()=>{c<e- 1&&d(++c)});const k=document.createElement(`button`);k.textContent=`>>`;k.addEventListener(`click`,()=>{c=e- 1;d(c)});a.append(f,g,h,j,k);i(c,b)});const a=document.querySelector(`.modern-table`);if(!a)return undefined;const b=10;let c=0;const d=Array.from(a.getElementsByTagName(`tr`)).slice(1);const e=Math.ceil(d.length/b);const f=document.querySelector(`.pagination`);h(f,e,g);g(c)});var guardarResultados=(()=>{const a=document.getElementById(`table-content`);const b=document.getElementById(`itemsCount`);const c=document.getElementById(`dataWeight`);const d=document.getElementById(`downloadBtn`);const e=a.querySelectorAll(`thead th`);e.forEach((e,f)=>{e.addEventListener(`mousedown`,()=>{if(!isHolding){isHolding=!0;heldHeaders.push(e.innerText);heldData.push(...[...a.querySelectorAll(`tbody tr`)].map(a=>{const b=a.children[f];return b?b.innerText:``}));const g=calcularPeso(heldData);b.textContent=heldData.length;c.textContent=`${g} KB`;d.disabled=!1}});e.addEventListener(`mouseup`,()=>{isHolding=!1})});d.addEventListener(`click`,()=>{descargarCSV()})});var updateForm=(()=>{const a=getUrlParams();if(Object.keys(a).length===0)return undefined;document.getElementById(`search-input`).value=a.query;document.getElementById(`age_min`).value=a.edad_min;document.getElementById(`age_max`).value=a.edad_max;document.getElementById(`balanceSlider`).value=a.peso_fts||50;document.getElementById(`vecinos`).value=a.k;const b=document.getElementById(`strategy`);b.value=a.strategy;document.getElementById(`value1Display`).textContent=a.peso_fts;document.getElementById(`value2Display`).textContent=a.peso_semantic;document.getElementById(`hiddenValue1`).value=a.peso_fts;document.getElementById(`hiddenValue2`).value=a.peso_semantic;const c=document.getElementsByName(`sexo`);for(const b of c)b.value===a.sexo&&(b.checked=!0)});var calcularPeso=(a=>{const b=JSON.stringify(a);const c=new Blob([b]).size;return (c/1024).toFixed(2)});var getUrlParams=(()=>{const a=new URLSearchParams(window.location.search);const b={};for(const [c,d] of a)b[c]=d;return b});let heldData=[];let heldHeaders=[];let isHolding=!1;document.addEventListener(`DOMContentLoaded`,async()=>{await updateHistorial();initHistorial();initKeyboard();updateForm();hideElements();initSlider();document.body.addEventListener(`htmx:afterRequest`,async()=>{await updateHistorial();initHistorial();guardarResultados();initPagination()})})